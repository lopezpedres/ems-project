"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadPageView = void 0;
const getPageFiles_1 = require("./getPageFiles");
const utils_1 = require("./utils");
async function loadPageView(pageContext) {
    const allPageFiles = pageContext._allPageFiles;
    const pageId = pageContext._pageId;
    const pageFile = (0, getPageFiles_1.findPageFile)(allPageFiles['.page'], pageId);
    if (!pageFile) {
        return {
            Page: null,
            pageExports: {},
            _pageFilePath: null
        };
    }
    (0, utils_1.assert)(pageFile);
    const { filePath, loadFile } = pageFile;
    const fileExports = await loadFile();
    (0, utils_1.assertUsage)(typeof fileExports === 'object' && ('Page' in fileExports || 'default' in fileExports), `${filePath} should have a \`export { Page }\` or \`export default\`.`);
    const pageExports = fileExports;
    const Page = pageExports['Page'] || pageExports['default'];
    const pageView = {
        Page,
        pageExports,
        _pageFilePath: filePath
    };
    (0, utils_1.assert)('Page' in pageView);
    (0, utils_1.assert)((0, utils_1.isObject)(pageView.pageExports));
    (0, utils_1.assert)(typeof pageView._pageFilePath === 'string');
    return pageView;
}
exports.loadPageView = loadPageView;
//# sourceMappingURL=loadPageView.js.map